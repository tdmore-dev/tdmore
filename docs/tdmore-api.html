<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>TDMore: an R package for therapeutic drug monitoring</title>
  <meta name="description" content="TDMore reference manual">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="TDMore: an R package for therapeutic drug monitoring" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="TDMore reference manual" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="TDMore: an R package for therapeutic drug monitoring" />
  
  <meta name="twitter:description" content="TDMore reference manual" />
  

<meta name="author" content="Ruben Faelens, Nicolas Luyckx, Quentin Leirens, Thomas Bouillon">


<meta name="date" content="2018-11-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="license.html">
<link rel="next" href="vignettes.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">TDMore bookdown</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to TDMore</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#prereq"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>2</b> Installation</a></li>
<li class="chapter" data-level="3" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i><b>3</b> License</a></li>
<li class="chapter" data-level="4" data-path="tdmore-api.html"><a href="tdmore-api.html"><i class="fa fa-check"></i><b>4</b> TDMore API</a><ul>
<li class="chapter" data-level="4.1" data-path="tdmore-api.html"><a href="tdmore-api.html#model-definition"><i class="fa fa-check"></i><b>4.1</b> Model definition</a><ul>
<li class="chapter" data-level="4.1.1" data-path="tdmore-api.html"><a href="tdmore-api.html#build-a-tdmore-object-from-a-nlxmir-model"><i class="fa fa-check"></i><b>4.1.1</b> Build a TDMore object from a nlxmir model</a></li>
<li class="chapter" data-level="4.1.2" data-path="tdmore-api.html"><a href="tdmore-api.html#build-a-tdmore-object-from-an-rxode-model"><i class="fa fa-check"></i><b>4.1.2</b> Build a TDMore object from an RxODE model</a></li>
<li class="chapter" data-level="4.1.3" data-path="tdmore-api.html"><a href="tdmore-api.html#build-your-own-algebraic-model"><i class="fa fa-check"></i><b>4.1.3</b> Build your own algebraic model</a></li>
<li class="chapter" data-level="4.1.4" data-path="tdmore-api.html"><a href="tdmore-api.html#add-covariates-to-the-model"><i class="fa fa-check"></i><b>4.1.4</b> Add covariates to the model</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tdmore-api.html"><a href="tdmore-api.html#regimen-object"><i class="fa fa-check"></i><b>4.2</b> Regimen object</a></li>
<li class="chapter" data-level="4.3" data-path="tdmore-api.html"><a href="tdmore-api.html#simulation-a-model"><i class="fa fa-check"></i><b>4.3</b> Simulation a model</a></li>
<li class="chapter" data-level="4.4" data-path="tdmore-api.html"><a href="tdmore-api.html#parameter-estimation"><i class="fa fa-check"></i><b>4.4</b> Parameter estimation</a></li>
<li class="chapter" data-level="4.5" data-path="tdmore-api.html"><a href="tdmore-api.html#dose-recommendation"><i class="fa fa-check"></i><b>4.5</b> Dose recommendation</a></li>
<li class="chapter" data-level="4.6" data-path="tdmore-api.html"><a href="tdmore-api.html#plotting-the-intermediate-steps"><i class="fa fa-check"></i><b>4.6</b> Plotting the intermediate steps</a></li>
<li class="chapter" data-level="4.7" data-path="tdmore-api.html"><a href="tdmore-api.html#extending-tdmore"><i class="fa fa-check"></i><b>4.7</b> Extending TDMore</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vignettes.html"><a href="vignettes.html"><i class="fa fa-check"></i><b>5</b> Vignettes</a><ul>
<li class="chapter" data-level="5.1" data-path="vignettes.html"><a href="vignettes.html#running-tdmore"><i class="fa fa-check"></i><b>5.1</b> Running TDMore</a><ul>
<li class="chapter" data-level="" data-path="vignettes.html"><a href="vignettes.html#whats-tdmore"><i class="fa fa-check"></i>What’s TDMore?</a></li>
<li class="chapter" data-level="" data-path="vignettes.html"><a href="vignettes.html#creating-your-model"><i class="fa fa-check"></i>Creating your model</a></li>
<li class="chapter" data-level="" data-path="vignettes.html"><a href="vignettes.html#predicting-new-data"><i class="fa fa-check"></i>Predicting new data</a></li>
<li class="chapter" data-level="" data-path="vignettes.html"><a href="vignettes.html#estimating-individual-parameters"><i class="fa fa-check"></i>Estimating individual parameters</a></li>
<li class="chapter" data-level="" data-path="vignettes.html"><a href="vignettes.html#finding-the-right-dose-to-give"><i class="fa fa-check"></i>Finding the right dose to give</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="vignettes.html"><a href="vignettes.html#multiple-endpoints"><i class="fa fa-check"></i><b>5.2</b> Multiple endpoints</a><ul>
<li class="chapter" data-level="" data-path="vignettes.html"><a href="vignettes.html#writing-and-testing-the-pk-model"><i class="fa fa-check"></i>Writing and testing the PK model</a></li>
<li class="chapter" data-level="" data-path="vignettes.html"><a href="vignettes.html#adding-a-pd-model"><i class="fa fa-check"></i>Adding a PD model</a></li>
<li class="chapter" data-level="" data-path="vignettes.html"><a href="vignettes.html#estimating-individual-parameters-1"><i class="fa fa-check"></i>Estimating individual parameters</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="vignettes.html"><a href="vignettes.html#example-detecting-non-adherence"><i class="fa fa-check"></i><b>5.3</b> Example: Detecting non-adherence</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="about-this-example.html"><a href="about-this-example.html"><i class="fa fa-check"></i><b>6</b> About this example</a></li>
<li class="chapter" data-level="7" data-path="the-model.html"><a href="the-model.html"><i class="fa fa-check"></i><b>7</b> The model</a></li>
<li class="chapter" data-level="8" data-path="is-the-patient-taking-hisher-medication.html"><a href="is-the-patient-taking-hisher-medication.html"><i class="fa fa-check"></i><b>8</b> Is the patient taking his/her medication?</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><code>TDMore</code>: an R package for therapeutic drug monitoring</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tdmore-api" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> TDMore API</h1>
<p>The following section shows an overview of the main methods from the TDMore API and tells you how to use them.</p>
<div id="model-definition" class="section level2">
<h2><span class="header-section-number">4.1</span> Model definition</h2>
<p>The TDMore model can be built using 3 different ways. Its model definition can be:</p>
<ul>
<li>a <a href="https://cran.r-project.org/package=nlmixr"><code>nlmixr</code></a> model</li>
<li>a <a href="https://cran.r-project.org/package=RxODE"><code>RxODE</code></a> model</li>
<li>a custom algebraic model</li>
</ul>
<p>These 3 ways will be explained in the next sections.</p>
<div id="build-a-tdmore-object-from-a-nlxmir-model" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Build a TDMore object from a nlxmir model</h3>
<p>Let’s implement a basic 1-compartment PK model in <code>nlmixr</code>. The model code is divided in two different blocks. The ‘ini’ block is used to define all the model parameter values (commonly called theta’s, omega’s and sigma’s in PK/PD modelling language) while the ‘model’ blocks defines all the equations of the model. The <code>nlmixr</code> function is implemented as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelCode1 &lt;-<span class="st"> </span><span class="cf">function</span>() {
  <span class="kw">ini</span>({
    TVKA &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># THETA on KA</span>
    TVV &lt;-<span class="st"> </span><span class="dv">70</span> <span class="co"># THETA on V</span>
    TVCL &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co"># THETA on CL</span>
    
    EKA <span class="op">~</span><span class="st"> </span><span class="fl">0.3</span> <span class="co"># ETA on KA (OMEGA, variance)</span>
    EV <span class="op">~</span><span class="st"> </span><span class="fl">0.3</span>  <span class="co"># ETA on V (OMEGA, variance)</span>
    ECL <span class="op">~</span><span class="st"> </span><span class="fl">0.3</span> <span class="co"># ETA on CL (OMEGA, variance)</span>
    
    SIGMA &lt;-<span class="st"> </span><span class="fl">0.1</span> <span class="co"># 10% CV proportional error</span>
  })
  <span class="kw">model</span>({
    KA &lt;-<span class="st"> </span>TVKA<span class="op">*</span><span class="kw">exp</span>(EKA)
    V &lt;-<span class="st"> </span>TVV<span class="op">*</span><span class="kw">exp</span>(EV)
    CL &lt;-<span class="st"> </span>TVCL<span class="op">*</span><span class="kw">exp</span>(ECL)

    d<span class="op">/</span><span class="kw">dt</span>(depot) =<span class="st"> </span><span class="op">-</span>KA<span class="op">*</span>depot
    d<span class="op">/</span><span class="kw">dt</span>(center) =<span class="st"> </span>KA<span class="op">*</span>depot <span class="op">-</span><span class="st"> </span>CL<span class="op">/</span>V<span class="op">*</span>center

    CONC =<span class="st"> </span>center<span class="op">/</span>V
    CONC <span class="op">~</span><span class="st"> </span><span class="kw">prop</span>(SIGMA)
  })
}</code></pre></div>
<p>A TDMore object can then be instantiated by running the following snippet:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tdmore)
<span class="kw">library</span>(nlmixr)
tdmore1 &lt;-<span class="st"> </span><span class="kw">nlmixrUI</span>(modelCode1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tdmore</span>()</code></pre></div>
<p>Your model is ready to use. Have a look at the content by calling:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(tdmore1)</code></pre></div>
<pre><code>## Structural model: RxODE 
## 
## Parameters:
##  name var        cv
##   EKA 0.3 0.5477226
##    EV 0.3 0.5477226
##   ECL 0.3 0.5477226
## 
## Covariates: / 
## 
## Residual error model:
##  name additiveError proportionalError exponentialError
##  CONC             0               0.1                0</code></pre>
<p>This summary tells you the model contains 3 parameters: EKA, EV and ECL. These parameters will be estimated by TDMore to fit individual observations as best as possible. The model does not have any covariates (to see how covariates are included, go to section X). Output variable is the ‘CONC’ variable. The residual error model on this variable is proportional. Please note that the underlying structural model is <code>RxODE</code>, not <code>nlxmir</code>. This is because the <code>nlxmir</code> model is automatically converted into a RxODE model. The <code>RxODE</code> package is used extensively in TDMore to simulate data.</p>
</div>
<div id="build-a-tdmore-object-from-an-rxode-model" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Build a TDMore object from an RxODE model</h3>
<p>The same TDMore object can be based on a <code>RxODE</code> model as well. This is done as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelCode2 &lt;-<span class="st"> &quot;</span>
<span class="st">  TVKA = 1</span>
<span class="st">  TVV = 70</span>
<span class="st">  TVCL = 4</span>
<span class="st">  KA &lt;- TVKA * exp(EKA)</span>
<span class="st">  V &lt;- TVV * exp(EV)</span>
<span class="st">  CL &lt;- TVCL * exp(ECL)</span>
<span class="st">  d/dt(depot) = -KA*depot</span>
<span class="st">  d/dt(center) = KA*depot - CL/V*center</span>
<span class="st">  CONC = center/V</span>
<span class="st">&quot;</span></code></pre></div>
<p>Note that the model is a character vector and not a function anymore. It does not include the ETA’s (and related OMEGA values). Furthemore, the residual error model is omitted. The missing information needs to be passed to TDMore as follows (arguments <code>omega</code> and <code>res_var</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tdmore)
<span class="kw">library</span>(RxODE)
omegaMatrix &lt;-<span class="st"> </span><span class="kw">vectorToDiagonalMatrix</span>(<span class="kw">c</span>(<span class="dt">EKA=</span><span class="fl">0.3</span>, <span class="dt">EV=</span><span class="fl">0.3</span>, <span class="dt">ECL=</span><span class="fl">0.3</span>))
errorModel &lt;-<span class="st"> </span><span class="kw">errorModel</span>(<span class="st">&quot;CONC&quot;</span>, <span class="dt">prop=</span><span class="fl">0.1</span>)
tdmore2 &lt;-<span class="st"> </span><span class="kw">RxODE</span>(modelCode2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tdmore</span>(<span class="dt">omega=</span>omegaMatrix, <span class="dt">res_var=</span><span class="kw">list</span>(errorModel))</code></pre></div>
<p>The omega matrix is a 3x3 matrix. Only the diagonal is used as you can see. However, correlations can be added if needed. Your model is now ready to use. It can be summarised this way:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(tdmore2)</code></pre></div>
<pre><code>## Structural model: RxODE 
## 
## Parameters:
##  name var        cv
##   EKA 0.3 0.5477226
##    EV 0.3 0.5477226
##   ECL 0.3 0.5477226
## 
## Covariates: / 
## 
## Residual error model:
##  name additiveError proportionalError exponentialError
##  CONC             0               0.1                0</code></pre>
<p>This summary is the exact same copy as the previous one!</p>
</div>
<div id="build-your-own-algebraic-model" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Build your own algebraic model</h3>
<p>Finally, <code>TDMore</code> can also work with algebraic models. To do so, the model definition function must return a object of class <code>algebraic_definition</code>. In particular, it must override the <code>predictFunction(times, regimen, ...)</code> which returns the output variable according to the <code>times</code> vector and specified <code>regimen</code>. The following code shows how the algebraic model can be implemented:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modelCode3 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">THETA=</span><span class="kw">list</span>(<span class="dt">KA=</span><span class="dv">1</span>, <span class="dt">V=</span><span class="dv">70</span>, <span class="dt">CL=</span><span class="dv">4</span>), <span class="dt">OMEGA=</span><span class="kw">list</span>(<span class="dt">KA=</span><span class="fl">0.3</span>, <span class="dt">V=</span><span class="fl">0.3</span>, <span class="dt">CL=</span><span class="fl">0.3</span>)) {
  <span class="kw">return</span>(<span class="kw">structure</span>(<span class="kw">list</span>(
    <span class="dt">predictFunction =</span> <span class="cf">function</span>(times, regimen, EKA, EV, ECL) {
      V =<span class="st"> </span>THETA<span class="op">$</span>V <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(EV)
      CL =<span class="st"> </span>THETA<span class="op">$</span>CL <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(ECL)
      KA =<span class="st"> </span>THETA<span class="op">$</span>KA <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(EKA)
      k =<span class="st"> </span>CL <span class="op">/</span><span class="st"> </span>V
      t =<span class="st"> </span>times
      
      CONC &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(times))
      <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(regimen))) { <span class="co"># Iterate over all regimen rows</span>
        tD =<span class="st"> </span>regimen<span class="op">$</span>TIME[i]
        D =<span class="st"> </span>regimen<span class="op">$</span>AMT[i]
        II =<span class="st"> </span>regimen<span class="op">$</span>II[i] <span class="co"># A number, 0, or NULL</span>
        <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.null</span>(II) <span class="op">&amp;&amp;</span><span class="st"> </span>II <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) { <span class="co"># Keep repeating the dose until we are past the last observation time</span>
          nbrDoses &lt;-<span class="st"> </span>row<span class="op">$</span>ADDL
          <span class="cf">while</span>(tD <span class="op">&lt;=</span><span class="st"> </span><span class="kw">max</span>(t) <span class="op">&amp;&amp;</span><span class="st"> </span>nbrDoses <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {
            CONC &lt;-<span class="st"> </span>CONC <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(t <span class="op">&gt;=</span><span class="st"> </span>tD, D<span class="op">/</span>V <span class="op">*</span><span class="st"> </span>(KA<span class="op">/</span>(KA<span class="op">-</span>k)) <span class="op">*</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>k<span class="op">*</span>(t<span class="op">-</span>tD)) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>KA<span class="op">*</span>(t<span class="op">-</span>tD))), <span class="dv">0</span>) <span class="co"># Algebraic solution of 1-cpt-model</span>
            tD &lt;-<span class="st"> </span>tD <span class="op">+</span><span class="st"> </span>II
            nbrDoses &lt;-<span class="st"> </span>nbrDoses <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
          }
        } <span class="cf">else</span> {
          <span class="co"># Single administration</span>
          CONC &lt;-<span class="st"> </span>CONC <span class="op">+</span><span class="st"> </span><span class="kw">ifelse</span>(t <span class="op">&gt;=</span><span class="st"> </span>tD, D<span class="op">/</span>V <span class="op">*</span><span class="st"> </span>(KA<span class="op">/</span>(KA<span class="op">-</span>k)) <span class="op">*</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>k<span class="op">*</span>(t<span class="op">-</span>tD)) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>KA<span class="op">*</span>(t<span class="op">-</span>tD))), <span class="dv">0</span>) <span class="co"># Algebraic solution of 1-cpt-model</span>
        }
      }
      <span class="kw">return</span>(CONC)
    },
    <span class="dt">omega =</span> <span class="kw">vectorToDiagonalMatrix</span>(<span class="kw">list</span>(<span class="dt">EKA=</span>OMEGA<span class="op">$</span>KA, <span class="dt">EV=</span>OMEGA<span class="op">$</span>V, <span class="dt">ECL=</span>OMEGA<span class="op">$</span>CL))),
    <span class="dt">class =</span> <span class="st">&quot;algebraic_definition&quot;</span>))
}</code></pre></div>
<p>The algebraic function definition needs to be passed to the <code>algebraic</code> function. This creates an <code>algebraic</code> model compatible with TDMore.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tdmore)
errorModel &lt;-<span class="st"> </span><span class="kw">errorModel</span>(<span class="st">&quot;CONC&quot;</span>, <span class="dt">prop=</span><span class="fl">0.1</span>)
tdmore3 &lt;-<span class="st"> </span><span class="kw">algebraic</span>(<span class="kw">modelCode3</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tdmore</span>(<span class="dt">res_var=</span><span class="kw">list</span>(errorModel))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(tdmore3)</code></pre></div>
<pre><code>## Structural model: algebraic 
## 
## Parameters:
##  name var        cv
##   EKA 0.3 0.5477226
##    EV 0.3 0.5477226
##   ECL 0.3 0.5477226
## 
## Covariates: / 
## 
## Residual error model:
##  name additiveError proportionalError exponentialError
##  CONC             0               0.1                0</code></pre>
</div>
<div id="add-covariates-to-the-model" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Add covariates to the model</h3>
</div>
</div>
<div id="regimen-object" class="section level2">
<h2><span class="header-section-number">4.2</span> Regimen object</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regimen &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">TIME=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">48</span>), <span class="dt">AMT=</span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">0</span>))</code></pre></div>
</div>
<div id="simulation-a-model" class="section level2">
<h2><span class="header-section-number">4.3</span> Simulation a model</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(tdmore1, <span class="dt">regimen=</span>regimen)</code></pre></div>
<p><img src="API_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(tdmore2, <span class="dt">regimen=</span>regimen)</code></pre></div>
<p><img src="API_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(tdmore3, <span class="dt">regimen=</span>regimen)</code></pre></div>
<p><img src="API_files/figure-html/unnamed-chunk-11-3.png" width="672" /></p>
</div>
<div id="parameter-estimation" class="section level2">
<h2><span class="header-section-number">4.4</span> Parameter estimation</h2>
</div>
<div id="dose-recommendation" class="section level2">
<h2><span class="header-section-number">4.5</span> Dose recommendation</h2>
</div>
<div id="plotting-the-intermediate-steps" class="section level2">
<h2><span class="header-section-number">4.6</span> Plotting the intermediate steps</h2>
</div>
<div id="extending-tdmore" class="section level2">
<h2><span class="header-section-number">4.7</span> Extending TDMore</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="license.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="vignettes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
